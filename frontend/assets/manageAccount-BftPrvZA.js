import{u as j,q as F,r as p,o as L,c as n,p as B,b as l,t as V,l as f,e as d,v as u,f as g,F as P,g as O,s as C,y as R,i as r}from"./index-C1K4ce6N.js";import{S as A}from"./sweetalert2.esm.all-DwEdJQJv.js";const E={class:"flex-1 rounded-xl bg-white flex flex-col overflow-hidden relative py-5 pl-5"},G={key:0,class:"flex-1 overflow-y-auto flex flex-col md:flex-row pr-5",style:{"scrollbar-gutter":"stable"}},_={class:"h-full w-full md:w-1/2 flex justify-center items-center min-w-fit pb-5 md:pb-0"},I={class:"h-64 w-64 rounded-full overflow-hidden relative"},J=["src"],K={key:1,class:"flex justify-center items-center text-7xl font-bold bg-[#FFD573] w-full h-full text-white"},X={key:0},z={key:1},Q={key:2,class:"absolute bg-black opacity-40 w-full h-full top-0"},W={key:0,class:"h-full w-full md:w-1/2 space-y-2"},Y={class:"flex w-full flex-col sm:flex-row sm:space-x-2"},Z={class:"w-full"},$=["disabled"],ee={class:"w-full"},le=["disabled"],ae=["disabled"],te=["disabled"],oe={class:"sm:flex"},se={class:"flex items-center"},ie=["disabled"],de=["disabled"],ne=["disabled"],re=["disabled"],ue={key:1,class:"h-full w-full md:w-1/2 space-y-2"},ce=["disabled"],fe=["disabled"],ve=["disabled"],pe=["disabled"],me={key:2},be={key:0,class:"absolute w-fit h-fit bottom-10 right-10 rounded-xl flex justify-center items-center space-x-2"},ge={key:1,class:"absolute w-fit h-fit bottom-10 right-10 rounded-xl flex justify-center items-center space-x-2"},he={__name:"manageAccount",setup(ye){const b=j(),y=O(),o=F(()=>y.getters.userData),w=p(null),D=()=>{w.value.click()},m=p(null),v=p(null),N=c=>{m.value=c.target.files[0];const e=new FileReader;e.onload=i=>{v.value=i.target.result},m.value&&e.readAsDataURL(m.value)},a=p({HoLot:"",HoTenNV:"",Ten:"",NgaySinh:"",SoDienThoai:"",Phai:"",DiaChi:"",email:"",ChucVu:"",MaDocGia:"",MSNV:"",avatar:""}),x=p({}),T=async()=>{a.value.SoDienThoai=o.value.SoDienThoai,a.value.DiaChi=o.value.DiaChi,o.value.ChucVu&&(a.value.HoTenNV=o.value.HoTenNV,a.value.MSNV=o.value.MSNV,a.value.ChucVu=o.value.ChucVu),o.value.ChucVu||(a.value.HoLot=o.value.HoLot,a.value.Ten=o.value.Ten,a.value.email=o.value.email,a.value.MaDocGia=o.value.MaDocGia,a.value.NgaySinh=o.value.NgaySinh.split("T")[0],a.value.Phai=o.value.Phai,a.value.avatar=o.value.avatar),x.value=JSON.parse(JSON.stringify(a.value)),await S()},s=p(!1),h=()=>{s.value&&(a.value=JSON.parse(JSON.stringify(x.value))),s.value=!s.value},S=async()=>{var c,e;try{if(a.value.avatar){const i=await C.getAvatar(a.value.avatar);v.value&&URL.revokeObjectURL(v.value),v.value=URL.createObjectURL(i)}}catch(i){const t=((e=(c=i.response)==null?void 0:c.data)==null?void 0:e.message)||"Có lỗi xảy ra. Vui lòng thử lại.";b.error(t)}},U=async()=>{(await A.fire({title:"Xác nhận lưu?",text:"Bạn có chắc muốn lưu các thay đổi này?",icon:"question",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Lưu",cancelButtonText:"Hủy"})).isConfirmed&&(await H(),s.value=!s.value)},M=c=>Object.fromEntries(Object.entries(c).filter(([e,i])=>i!==null&&i!=="")),H=async()=>{var c,e;try{const i=new FormData,t=M(a.value);for(const k in t)i.append(k,t[k]);m.value&&i.append("file",m.value);const q=await C.update(o.value._id,i);await y.dispatch("checkLoggedIn"),b.success(q.message)}catch(i){const t=((e=(c=i.response)==null?void 0:c.data)==null?void 0:e.message)||"Có lỗi xảy ra. Vui lòng thử lại.";b.error(t)}};return L(()=>{T()}),(c,e)=>{const i=R("router-view");return r(),n(P,null,[B(i),l("div",E,[e[35]||(e[35]=l("div",{class:"h-fit w-full mb-5 items-center"},[l("h3",{class:"font-bold text-lg whitespace-nowrap"},"Hồ sơ tài khoản")],-1)),o.value?(r(),n("div",G,[l("div",_,[l("div",I,[a.value.avatar||v.value?(r(),n("img",{key:0,src:v.value,alt:"",class:"rounded-full object-cover"},null,8,J)):(r(),n("div",K,[a.value.Ten?(r(),n("div",X,V(a.value.Ten.charAt(0).toUpperCase()),1)):f("",!0),a.value.HoTenNV?(r(),n("div",z,V(a.value.HoTenNV.split(" ").pop().charAt(0).toUpperCase()),1)):f("",!0)])),s.value&&!("ChucVu"in o.value)?(r(),n("div",Q)):f("",!0),s.value&&!("ChucVu"in o.value)?(r(),n("div",{key:3,onClick:D,class:"absolute w-16 h-16 rounded-full bg-slate-100 opacity-50 top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 flex justify-center items-center cursor-pointer"},e[15]||(e[15]=[l("i",{class:"fa-solid fa-file-import text-2xl"},null,-1)]))):f("",!0),l("input",{type:"file",ref_key:"fileInput",ref:w,class:"hidden",accept:"image/*",onChange:N},null,544)])]),"ChucVu"in o.value?f("",!0):(r(),n("div",W,[l("div",Y,[l("div",Z,[e[16]||(e[16]=l("label",{for:"firstName",class:"block font-medium text-gray-700 whitespace-nowrap"},"Họ & Tên đệm",-1)),d(l("input",{disabled:!s.value,type:"text",id:"firstName","onUpdate:modelValue":e[0]||(e[0]=t=>a.value.HoLot=t),class:"mt-1 block w-full px-3 py-2 text-black border border-[#aaa] rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500",required:""},null,8,$),[[u,a.value.HoLot]])]),l("div",ee,[e[17]||(e[17]=l("label",{for:"name",class:"block font-medium text-gray-700 whitespace-nowrap"},"Tên",-1)),d(l("input",{disabled:!s.value,type:"text",id:"name","onUpdate:modelValue":e[1]||(e[1]=t=>a.value.Ten=t),class:"mt-1 block w-full px-3 py-2 text-black border border-[#aaa] rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500",required:""},null,8,le),[[u,a.value.Ten]])])]),l("div",null,[e[18]||(e[18]=l("label",{for:"id",class:"block font-medium text-gray-700 whitespace-nowrap"},"Mã độc giả",-1)),d(l("input",{disabled:!0,type:"text",id:"id","onUpdate:modelValue":e[2]||(e[2]=t=>a.value.MaDocGia=t),class:"mt-1 block w-full px-3 py-2 text-black border border-[#aaa] rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500",required:""},null,512),[[u,a.value.MaDocGia]])]),l("div",null,[e[19]||(e[19]=l("label",{for:"date",class:"block font-medium text-gray-700 whitespace-nowrap"},"Ngày sinh",-1)),d(l("input",{disabled:!s.value,type:"date",id:"date","onUpdate:modelValue":e[3]||(e[3]=t=>a.value.NgaySinh=t),class:"mt-1 block w-full px-3 py-2 text-black border border-[#aaa] rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500",required:""},null,8,ae),[[u,a.value.NgaySinh]])]),l("div",null,[e[20]||(e[20]=l("label",{for:"phone",class:"block font-medium text-gray-700 whitespace-nowrap"},"Số điện thoại",-1)),d(l("input",{disabled:!s.value,type:"tel",pattern:"[0-9]{10}",id:"phone","onUpdate:modelValue":e[4]||(e[4]=t=>a.value.SoDienThoai=t),class:"mt-1 block w-full px-3 py-2 text-black border border-[#aaa] rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500",required:""},null,8,te),[[u,a.value.SoDienThoai]])]),l("div",oe,[e[24]||(e[24]=l("label",{class:"block font-medium text-gray-700 whitespace-nowrap mr-5 my-3"},"Giới tính",-1)),l("div",se,[d(l("input",{disabled:!s.value,type:"radio",id:"male",value:"Nam","onUpdate:modelValue":e[5]||(e[5]=t=>a.value.Phai=t),class:"mr-2",required:""},null,8,ie),[[g,a.value.Phai]]),e[21]||(e[21]=l("label",{for:"male",class:"mr-4"},"Nam",-1)),d(l("input",{disabled:!s.value,type:"radio",id:"female",value:"Nữ","onUpdate:modelValue":e[6]||(e[6]=t=>a.value.Phai=t),class:"mr-2",required:""},null,8,de),[[g,a.value.Phai]]),e[22]||(e[22]=l("label",{for:"female",class:"mr-4"},"Nữ",-1)),d(l("input",{disabled:!s.value,type:"radio",id:"other",value:"Khác","onUpdate:modelValue":e[7]||(e[7]=t=>a.value.Phai=t),class:"mr-2",required:""},null,8,ne),[[g,a.value.Phai]]),e[23]||(e[23]=l("label",{for:"other"},"Khác",-1))])]),l("div",null,[e[25]||(e[25]=l("label",{for:"address",class:"block font-medium text-gray-700 whitespace-nowrap"},"Địa chỉ",-1)),d(l("input",{disabled:!s.value,type:"text",id:"address","onUpdate:modelValue":e[8]||(e[8]=t=>a.value.DiaChi=t),class:"mt-1 block w-full px-3 py-2 text-black border border-[#aaa] rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500"},null,8,re),[[u,a.value.DiaChi]])]),l("div",null,[e[26]||(e[26]=l("label",{for:"email",class:"block font-medium text-gray-700 whitespace-nowrap"},"Email",-1)),d(l("input",{disabled:!0,type:"email",id:"email","onUpdate:modelValue":e[9]||(e[9]=t=>a.value.email=t),class:"mt-1 block w-full px-3 py-2 text-black border border-[#aaa] rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500",required:""},null,512),[[u,a.value.email]])])])),"ChucVu"in o.value?(r(),n("div",ue,[l("div",null,[e[27]||(e[27]=l("label",{for:"hoTen",class:"block font-medium text-gray-700 whitespace-nowrap"},"Họ tên nhân viên",-1)),d(l("input",{disabled:!s.value,type:"text",id:"hoTen","onUpdate:modelValue":e[10]||(e[10]=t=>a.value.HoTenNV=t),class:"mt-1 block w-full px-3 py-2 text-black border border-[#aaa] rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500",required:""},null,8,ce),[[u,a.value.HoTenNV]])]),l("div",null,[e[28]||(e[28]=l("label",{for:"id_nv",class:"block font-medium text-gray-700 whitespace-nowrap"},"Mã số nhân viên",-1)),d(l("input",{disabled:!0,type:"text",id:"id_nv","onUpdate:modelValue":e[11]||(e[11]=t=>a.value.MSNV=t),class:"mt-1 block w-full px-3 py-2 text-black border border-[#aaa] rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500",required:""},null,512),[[u,a.value.MSNV]])]),l("div",null,[e[29]||(e[29]=l("label",{for:"cv",class:"block font-medium text-gray-700 whitespace-nowrap"},"Chức vụ",-1)),d(l("input",{disabled:!s.value,type:"text",id:"cv","onUpdate:modelValue":e[12]||(e[12]=t=>a.value.ChucVu=t),class:"mt-1 block w-full px-3 py-2 text-black border border-[#aaa] rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500",required:""},null,8,fe),[[u,a.value.ChucVu]])]),l("div",null,[e[30]||(e[30]=l("label",{for:"phone",class:"block font-medium text-gray-700 whitespace-nowrap"},"Số điện thoại",-1)),d(l("input",{disabled:!s.value,type:"tel",pattern:"[0-9]{10}",id:"phone","onUpdate:modelValue":e[13]||(e[13]=t=>a.value.SoDienThoai=t),class:"mt-1 block w-full px-3 py-2 text-black border border-[#aaa] rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500",required:""},null,8,ve),[[u,a.value.SoDienThoai]])]),l("div",null,[e[31]||(e[31]=l("label",{for:"address",class:"block font-medium text-gray-700 whitespace-nowrap"},"Địa chỉ",-1)),d(l("input",{disabled:!s.value,type:"text",id:"address","onUpdate:modelValue":e[14]||(e[14]=t=>a.value.DiaChi=t),class:"mt-1 block w-full px-3 py-2 text-black border border-[#aaa] rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500"},null,8,pe),[[u,a.value.DiaChi]])])])):f("",!0),"ChucVu"in o.value?f("",!0):(r(),n("div",me,[s.value?(r(),n("div",be,[l("div",{onClick:U,class:"flex items-center w-fit h-fit bg-green-300 rounded-lg cursor-pointer"},e[32]||(e[32]=[l("div",{class:"w-10 h-10 flex justify-center items-center"},[l("i",{class:"fa-regular fa-circle-check"})],-1),l("span",{class:"pr-4"},"Lưu",-1)])),l("div",{onClick:h,class:"flex items-center w-fit h-fit bg-slate-300 rounded-lg cursor-pointer"},e[33]||(e[33]=[l("div",{class:"w-10 h-10 flex justify-center items-center"},[l("i",{class:"fa-solid fa-ban"})],-1),l("span",{class:"pr-4"},"Hủy",-1)]))])):(r(),n("div",ge,[l("div",{onClick:h,class:"flex items-center w-fit h-fit bg-[#FFD573] hover:bg-[#FEF6DF] rounded-lg cursor-pointer"},e[34]||(e[34]=[l("span",{class:"pl-4"},"Chỉnh sửa",-1),l("div",{class:"w-10 h-10 flex justify-center items-center"},[l("i",{class:"fa-regular fa-pen-to-square"})],-1)]))]))]))])):f("",!0)])],64)}}};export{he as default};
