import{h as B,u as D,r,o as E,x as j,i as d,c as f,b as e,t as _,z as M,F as x,A as T,B as C,a as A,p as k,e as S,v as N,C as V,m as L,l as $,y as z}from"./index-BHu86sKb.js";import{c as F}from"./category_service-B_6P0n0i.js";import{S as H}from"./sweetalert2.esm.all-DwEdJQJv.js";const O={class:"p-2"},I={class:"p-2"},K={class:"p-2 flex justify-end"},R={class:"relative inline-block"},X={__name:"manageCategoryItem",props:{item:{type:Object}},setup(h){const m=B(),y=D(),l=h,s=r(!1),i=r(null),c=r(null),p=r(!1),b=async()=>{if(s.value=!s.value,s.value){await T();const t=c.value.getBoundingClientRect(),o=window.innerHeight;t.bottom>o&&(p.value=!0)}},v=t=>{s.value&&!i.value.contains(t.target)&&!c.value.contains(t.target)&&(s.value=!1)},g=async()=>{if((await H.fire({title:"Xác nhận xóa?",text:"Bạn sẽ không thể khôi phục lại điều này!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#d33",cancelButtonColor:"#3085d6",confirmButtonText:"Xóa",cancelButtonText:"Hủy"})).isConfirmed){const o=await F.delete(l.item._id);y.success(o.message),C.emit("reload")}},u=()=>{s.value=!1,m.push({name:"manageCategoryView",params:{id:l.item._id}})},n=()=>{s.value=!1,m.push({name:"manageCategoryEdit",params:{id:l.item._id}})};return E(()=>{document.addEventListener("click",v)}),j(()=>{document.removeEventListener("click",v)}),(t,o)=>{var a,w;return d(),f(x,null,[e("td",O,_(((a=h.item)==null?void 0:a.MaMucSach)||"N/A"),1),e("td",I,_(((w=h.item)==null?void 0:w.TenMucSach)||"N/A"),1),e("td",K,[e("div",R,[e("div",{onClick:b,ref_key:"dropdownButton",ref:i,class:"flex items-center justify-center w-10 h-10 rounded-full cursor-pointer hover:bg-[#FFD573]"},o[0]||(o[0]=[e("i",{class:"fa-solid fa-ellipsis-vertical"},null,-1)]),512),e("div",{class:M([{hidden:!s.value,"bottom-full mb-2":p.value},"absolute bg-white shadow-lg rounded-lg w-40 border mt-2 z-10 right-0"]),ref_key:"dropdownMenu",ref:c},[e("ul",{class:"py-2"},[e("li",{onClick:n,class:"px-4 py-2 cursor-pointer hover:bg-[#FEF6DF]"},"Cập nhật"),e("li",{onClick:g,class:"px-4 py-2 cursor-pointer hover:bg-[#FEF6DF]"},"Xóa"),e("li",{onClick:u,class:"px-4 py-2 cursor-pointer hover:bg-[#FEF6DF]"},"Chi tiết")])],2)])])],64)}}},U={class:"flex-1 rounded-xl bg-white flex flex-col overflow-hidden relative py-5 pl-5"},q={class:"h-fit w-full items-center pr-5"},Q={class:"flex items-center justify-end h-fit"},G={class:"w-full sm:w-1/2 flex justify-end border border-slate-500 focus-within:border-blue-500 rounded-2xl overflow-hidden bg-white"},J={class:"flex-1 relative overflow-y-auto mt-10 pr-5",style:{"scrollbar-gutter":"stable"}},P={class:"table-auto w-full"},W={key:0,class:"text-center py-2 cursor-pointer w-full h-fit hover:bg-[#FEF6DF]"},te={__name:"manageCategory",setup(h){const m=B(),y=D(),l=r(""),s=r([]),i=r(!1),c=async()=>{var n,t;try{const o=await F.getAll();s.value=o}catch(o){const a=((t=(n=o.response)==null?void 0:n.data)==null?void 0:t.message)||"Có lỗi xảy ra. Vui lòng thử lại.";y.error(a)}},p=()=>{m.push({name:"manageCategoryAdd"})},b=()=>{l.value="",i.value=!1},v=()=>{l.value!==""?i.value=!0:i.value=!1},g=r(!1),u=async()=>{try{if(l.value.trim()){const n=await F.getOne(l.value);s.value=n}}catch{g.value=!0}};return E(()=>{C.on("reload",()=>{l.value.trim()===""?c():u()})}),A(()=>{C.off("reload")}),(n,t)=>{const o=z("router-view");return d(),f(x,null,[k(o),e("div",U,[e("div",q,[t[3]||(t[3]=e("h3",{class:"font-bold text-lg whitespace-nowrap mb-5"},"Quản lý danh mục sách",-1)),e("div",Q,[e("div",G,[S(e("input",{type:"text",class:"h-10 flex-1 pl-4 text-sm focus:outline-none",onKeydown:V(u,["enter"]),"onUpdate:modelValue":t[0]||(t[0]=a=>l.value=a),onInput:v,placeholder:"Tìm kiếm mục sách..."},null,544),[[N,l.value]]),e("div",{class:M(["flex items-center justify-center w-10 h-10 hover:bg-slate-300 rounded-full bg-white",i.value?"flex":"hidden"]),onClick:b},t[1]||(t[1]=[e("i",{class:"fa-solid fa-circle-xmark"},null,-1)]),2),e("div",{class:"w-10 h-10 bg-white flex items-center justify-center cursor-pointer border-l-2",onClick:u},t[2]||(t[2]=[e("i",{class:"fa-solid fa-magnifying-glass"},null,-1)]))])])]),e("div",J,[e("table",P,[t[4]||(t[4]=e("thead",null,[e("tr",{class:"text-left sticky top-0 border-b-2 border-x-0 bg-white m-0 z-20"},[e("th",{class:"p-2 w-fit"}," Mã mục sách"),e("th",{class:"p-2 w-fit"}," Tên mục sách"),e("th",{class:"p-2 w-16"})])],-1)),e("tbody",null,[(d(!0),f(x,null,L(s.value,(a,w)=>(d(),f("tr",{class:"border-y-2 border-x-0 cursor-pointer hover:bg-[#FEF6DF]",key:w},[k(X,{item:a},null,8,["item"])]))),128))])]),g.value?(d(),f("div",W,"Không tìm thấy kết quả phù hợp!")):$("",!0),e("button",{onClick:c,class:"text-left py-2 px-4 rounded-2xl mt-5 text-blue-600 cursor-pointer w-fit h-fit hover:bg-[#FEF6DF]"},"Hiển thị tất cả")]),e("div",{class:"absolute w-fit h-fit bottom-6 right-6 rounded-xl flex justify-center items-center space-x-2"},[e("div",{onClick:p,class:"flex items-center w-fit h-fit bg-[#FFD573] hover:bg-[#FEF6DF] rounded-lg cursor-pointer"},t[5]||(t[5]=[e("span",{class:"pl-4"},"Thêm",-1),e("div",{class:"w-10 h-10 flex justify-center items-center"},[e("i",{class:"fa-solid fa-plus"})],-1)]))])])],64)}}};export{te as default};
