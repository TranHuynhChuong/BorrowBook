import{h as D,u as E,r as a,o as N,x as T,i as f,c as h,b as e,t as y,z as j,F,A,B as _,a as M,p as B,e as X,v as V,C as $,m as L,l as P,y as S}from"./index-C1K4ce6N.js";import{p as k}from"./publisher_service-B5UwPzYN.js";import{S as z}from"./sweetalert2.esm.all-DwEdJQJv.js";const H={class:"p-2"},O={class:"p-2"},I={class:"p-2"},K={class:"p-2 flex justify-end"},R={class:"relative inline-block"},U={__name:"managePublisherItem",props:{item:{type:Object}},setup(u){const p=D(),g=E(),l=u,s=a(!1),i=a(null),c=a(null),m=a(!1),x=async()=>{if(s.value=!s.value,s.value){await A();const t=c.value.getBoundingClientRect(),o=window.innerHeight;t.bottom>o&&(m.value=!0)}},v=t=>{s.value&&!i.value.contains(t.target)&&!c.value.contains(t.target)&&(s.value=!1)},w=async()=>{if((await z.fire({title:"Xác nhận xóa?",text:"Bạn sẽ không thể khôi phục lại điều này!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#d33",cancelButtonColor:"#3085d6",confirmButtonText:"Xóa",cancelButtonText:"Hủy"})).isConfirmed){const o=await k.delete(l.item._id);g.success(o.message),_.emit("reload")}},d=()=>{s.value=!1,p.push({name:"managePublisherView",params:{id:l.item._id}})},n=()=>{s.value=!1,p.push({name:"managePublisherEdit",params:{id:l.item._id}})};return N(()=>{document.addEventListener("click",v)}),T(()=>{document.removeEventListener("click",v)}),(t,o)=>{var r,b,C;return f(),h(F,null,[e("td",H,y(((r=u.item)==null?void 0:r.MaNXB)||"N/A"),1),e("td",O,y(((b=u.item)==null?void 0:b.TenNXB)||"N/A"),1),e("td",I,y(((C=u.item)==null?void 0:C.DiaChi)||"N/A"),1),e("td",K,[e("div",R,[e("div",{onClick:x,ref_key:"dropdownButton",ref:i,class:"flex items-center justify-center w-10 h-10 rounded-full cursor-pointer hover:bg-[#FFD573]"},o[0]||(o[0]=[e("i",{class:"fa-solid fa-ellipsis-vertical"},null,-1)]),512),e("div",{class:j([{hidden:!s.value,"bottom-full mb-2":m.value},"absolute bg-white shadow-lg rounded-lg w-40 border mt-2 z-10 right-0"]),ref_key:"dropdownMenu",ref:c},[e("ul",{class:"py-2"},[e("li",{onClick:n,class:"px-4 py-2 cursor-pointer hover:bg-[#FEF6DF]"},"Cập nhật"),e("li",{onClick:w,class:"px-4 py-2 cursor-pointer hover:bg-[#FEF6DF]"},"Xóa"),e("li",{onClick:d,class:"px-4 py-2 cursor-pointer hover:bg-[#FEF6DF]"},"Chi tiết")])],2)])])],64)}}},q={class:"flex-1 rounded-xl bg-white flex flex-col overflow-hidden relative py-5 pl-5"},Q={class:"h-fit w-full items-center pr-5"},G={class:"flex items-center justify-end h-fit"},J={class:"w-full sm:w-1/2 flex justify-end border border-slate-500 focus-within:border-blue-500 rounded-2xl overflow-hidden bg-white"},W={class:"flex-1 relative overflow-y-auto mt-10 pr-5",style:{"scrollbar-gutter":"stable"}},Y={class:"table-auto w-full"},Z={key:0,class:"text-center py-2 cursor-pointer w-full h-fit hover:bg-[#FEF6DF]"},oe={__name:"managePublisher",setup(u){const p=D(),g=E(),l=a(""),s=a([]),i=a(!1),c=async()=>{var n,t;try{const o=await k.getAll();s.value=o}catch(o){const r=((t=(n=o.response)==null?void 0:n.data)==null?void 0:t.message)||"Có lỗi xảy ra. Vui lòng thử lại.";g.error(r)}},m=()=>{p.push({name:"managePublisherAdd"})},x=()=>{l.value="",i.value=!1},v=()=>{l.value!==""?i.value=!0:i.value=!1},w=a(!1),d=async()=>{try{if(l.value.trim()){const n=await k.getOne(l.value);s.value=n}}catch{w.value=!0}};return N(()=>{_.on("reload",()=>{l.value.trim()===""?c():d()})}),M(()=>{_.off("reload")}),(n,t)=>{const o=S("router-view");return f(),h(F,null,[B(o),e("div",q,[e("div",Q,[t[3]||(t[3]=e("h3",{class:"font-bold text-lg whitespace-nowrap mb-5"},"Quản lý nhà xuất bản",-1)),e("div",G,[e("div",J,[X(e("input",{type:"text",class:"h-10 flex-1 pl-4 text-sm focus:outline-none",onKeydown:$(d,["enter"]),"onUpdate:modelValue":t[0]||(t[0]=r=>l.value=r),onInput:v,placeholder:"Tìm kiếm nhà xuất bản..."},null,544),[[V,l.value]]),e("div",{class:j(["flex items-center justify-center w-10 h-10 hover:bg-slate-300 rounded-full bg-white",i.value?"flex":"hidden"]),onClick:x},t[1]||(t[1]=[e("i",{class:"fa-solid fa-circle-xmark"},null,-1)]),2),e("div",{class:"w-10 h-10 bg-white flex items-center justify-center cursor-pointer border-l-2",onClick:d},t[2]||(t[2]=[e("i",{class:"fa-solid fa-magnifying-glass"},null,-1)]))])])]),e("div",W,[e("table",Y,[t[4]||(t[4]=e("thead",null,[e("tr",{class:"text-left sticky top-0 border-b-2 border-x-0 bg-white m-0 z-20"},[e("th",{class:"p-2 w-fit"}," Mã NXB"),e("th",{class:"p-2 w-auto"}," Tên NXB"),e("th",{class:"p-2 w-auto"}," Địa chỉ"),e("th",{class:"p-2 w-16"})])],-1)),e("tbody",null,[(f(!0),h(F,null,L(s.value,(r,b)=>(f(),h("tr",{class:"border-y-2 border-x-0 cursor-pointer hover:bg-[#FEF6DF]",key:b},[B(U,{item:r},null,8,["item"])]))),128))])]),w.value?(f(),h("div",Z,"Không tìm thấy kết quả phù hợp!")):P("",!0),e("button",{onClick:c,class:"text-left py-2 px-4 rounded-2xl mt-5 text-blue-600 cursor-pointer w-fit h-fit hover:bg-[#FEF6DF]"},"Hiển thị tất cả")]),e("div",{class:"absolute w-fit h-fit bottom-6 right-6 rounded-xl flex justify-center items-center space-x-2"},[e("div",{onClick:m,class:"flex items-center w-fit h-fit bg-[#FFD573] hover:bg-[#FEF6DF] rounded-lg cursor-pointer"},t[5]||(t[5]=[e("span",{class:"pl-4"},"Thêm",-1),e("div",{class:"w-10 h-10 flex justify-center items-center"},[e("i",{class:"fa-solid fa-plus"})],-1)]))])])],64)}}};export{oe as default};
