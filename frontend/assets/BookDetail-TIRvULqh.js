import{b as p}from"./book_service-CvQVwSpB.js";import{u as B,r as f,q as S,o as T,c as D,b as t,t as l,h as k,s as C,g as N,i as j}from"./index-bggiZOz8.js";import{S as F}from"./sweetalert2.esm.all-DwEdJQJv.js";const M={class:"pt-5 pl-5 flex w-full flex-col lg:flex-row bg-white"},X={class:"flex-1 flex overflow-hidden"},L={class:"w-full h-full"},q={class:"h-full flex justify-center flex-col lg:flex-row items-center overflow-y-auto overflow-x-hidden rounded-lg",style:{"scrollbar-gutter":"stable"}},G={class:"h-full w-fit overflow-hidden p-5 lg:p-20"},I=["src"],E={class:"h-1/3 w-fit lg:h-full p-5 flex flex-col rounded-lg"},H={class:"h-fit w-full flex flex-row"},R={class:"flex-1 h-full flex flex-col"},U={class:"flex justify-between items-center mb-5"},V={class:"text-xl font-semibold px-4"},O={class:"flex-1"},K={class:"table-auto w-full border-collapse"},z={class:"px-4 py-2 whitespace-nowrap align-top"},A={class:"px-4 py-2 align-top"},J={class:"px-4 py-2 align-top"},P={class:"px-4 py-2 align-top"},Q={class:"px-4 py-2 whitespace-nowrap align-top"},W={class:"px-4 py-2 whitespace-nowrap align-top"},Y={class:"px-4 py-2 whitespace-nowrap align-top"},st={__name:"BookDetail",props:{id:{type:Object}},setup(h){const r=k(),i=B(),c=h,g=()=>{r.go(-1)},d=f(null),w=async o=>{const s=await p.getImg(o);d.value=URL.createObjectURL(s)},x=o=>o?o.toString().replace(/\B(?=(\d{3})+(?!\d))/g,".")+" vnd":"0 vnd",e=f({MaSach:"",TenSach:"",TacGia:"",NamXuatBan:0,DonGia:0,BiaSach:"",NXB:"",TheLoai:"",SoLuongHienTai:0}),m=async()=>{try{const o=await p.get(c.id);e.value=o,w(e.value.BiaSach)}catch(o){console.log(o)}},y=async()=>{u.value?(await F.fire({title:"Xác nhận đăng ký mượn?",text:`Bạn có chắc muốn đăng ký để mượn quyển sách này?

Bạn có thể đến nhận sách tại quầy sau khi đăng ký.`,icon:"question",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Xác nhận",cancelButtonText:"Hủy"})).isConfirmed&&await v():r.push({name:"login"})},v=async()=>{var o,s;try{const n=new Date,a={ID_DocGia:u.value._id,ID_Sach:c.id,NgayMuon:n,TrangThai:"DangKy"},_=await C.borrow(a);i.success(_.message)}catch(n){const a=((s=(o=n.response)==null?void 0:o.data)==null?void 0:s.message)||"Có lỗi xảy ra. Vui lòng thử lại.";i.error(a)}},b=N(),u=S(()=>b.getters.userData);return T(async()=>{var o,s;try{m()}catch(n){const a=((s=(o=n.response)==null?void 0:o.data)==null?void 0:s.message)||"Có lỗi xảy ra. Vui lòng thử lại.";i.error(a)}}),(o,s)=>(j(),D("div",M,[t("div",{class:"h-ful w-fit"},[t("div",{class:"w-10 h-10 rounded-full flex justify-center items-center hover:bg-[#FEF6DF] cursor-pointer border shadow bg-white",onClick:g},s[0]||(s[0]=[t("i",{class:"fa-solid fa-arrow-left"},null,-1)]))]),t("div",X,[t("div",L,[t("div",q,[t("div",G,[t("img",{src:d.value,alt:"",class:"object-contain h-full w-auto min-w-fit rounded-md shadow-lg"},null,8,I)]),t("div",E,[t("div",H,[t("div",R,[t("div",U,[t("span",V,l(e.value.TenSach),1)]),t("div",O,[t("table",K,[t("tbody",null,[t("tr",null,[s[1]||(s[1]=t("td",{class:"px-4 py-2 font-semibold whitespace-nowrap align-top"}," Mã sách",-1)),t("td",z,l(e.value.MaSach),1)]),t("tr",null,[s[2]||(s[2]=t("td",{class:"px-4 py-2 font-semibold whitespace-nowrap align-top"}," Thể loại",-1)),t("td",A,l(e.value.TheLoai.TenMucSach),1)]),t("tr",null,[s[3]||(s[3]=t("td",{class:"px-4 py-2 font-semibold whitespace-nowrap align-top"},"Tác giả",-1)),t("td",J,l(e.value.TacGia),1)]),t("tr",null,[s[4]||(s[4]=t("td",{class:"px-4 py-2 font-semibold whitespace-nowrap align-top"}," Nhà xuất bản ",-1)),t("td",P,l(e.value.NXB.TenNXB),1)]),t("tr",null,[s[5]||(s[5]=t("td",{class:"px-4 py-2 font-semibold whitespace-nowrap align-top"}," Năm xuất bản ",-1)),t("td",Q,l(e.value.NamXuatBan),1)]),t("tr",null,[s[6]||(s[6]=t("td",{class:"px-4 py-2 font-semibold whitespace-nowrap align-top"}," Số lượng",-1)),t("td",W,l(e.value.SoLuongHienTai)+" quyển ",1)]),t("tr",null,[s[7]||(s[7]=t("td",{class:"px-4 py-2 font-semibold whitespace-nowrap align-top"}," Đơn giá",-1)),t("td",Y,l(x(e.value.DonGia)),1)])])])])])]),t("div",{class:"h-fit w-full flex justify-end py-10"},[t("div",{class:"flex flex-1 h-full justify-end"},[t("button",{onClick:y,class:"rounded-xl hover:bg-[#FEF6DF] bg-[#FFD573] px-5 py-3"},"Đăng ký mượn")])])])])])])]))}};export{st as default};
