import{b as p}from"./book_service-DSk0N-db.js";import{u as T,r as f,q as k,o as D,c as h,b as t,t as n,l as C,h as N,s as j,g as F,i as g}from"./index-BHu86sKb.js";import{S as M}from"./sweetalert2.esm.all-DwEdJQJv.js";const X={class:"pt-5 pl-5 flex w-full flex-col lg:flex-row bg-white"},L={class:"flex-1 flex overflow-hidden"},q={class:"w-full h-full"},G={class:"h-full flex justify-center flex-col lg:flex-row items-center overflow-y-auto overflow-x-hidden rounded-lg",style:{"scrollbar-gutter":"stable"}},V={class:"h-full w-fit overflow-hidden p-5 lg:p-20"},H=["src"],I={class:"h-1/3 w-fit lg:h-full p-5 flex flex-col rounded-lg"},E={class:"h-fit w-full flex flex-row"},R={class:"flex-1 h-full flex flex-col"},U={class:"flex justify-between items-center mb-5"},O={class:"text-xl font-semibold px-4"},K={class:"flex-1"},z={class:"table-auto w-full border-collapse"},A={class:"px-4 py-2 whitespace-nowrap align-top"},J={class:"px-4 py-2 align-top"},P={class:"px-4 py-2 align-top"},Q={class:"px-4 py-2 align-top"},W={class:"px-4 py-2 whitespace-nowrap align-top"},Y={class:"px-4 py-2 whitespace-nowrap align-top"},Z={class:"px-4 py-2 whitespace-nowrap align-top"},$={class:"h-fit w-full flex justify-end py-10"},tt={key:0,class:"flex flex-1 h-full justify-end"},lt={__name:"BookDetail",props:{id:{type:Object}},setup(w){const r=N(),c=T(),u=w,x=()=>{r.go(-1)},d=f(null),m=async o=>{const s=await p.getImg(o);d.value=URL.createObjectURL(s)},y=o=>o?o.toString().replace(/\B(?=(\d{3})+(?!\d))/g,".")+" vnd":"0 vnd",e=f({MaSach:"",TenSach:"",TacGia:"",NamXuatBan:0,DonGia:0,BiaSach:"",NXB:"",TheLoai:"",SoLuongHienTai:0}),v=async()=>{try{const o=await p.get(u.id);e.value=o,m(e.value.BiaSach)}catch(o){console.log(o)}},_=async()=>{i.value?(await M.fire({title:"Xác nhận đăng ký mượn?",text:`Bạn có chắc muốn đăng ký để mượn quyển sách này?

Bạn có thể đến nhận sách tại quầy sau khi đăng ký.`,icon:"question",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Xác nhận",cancelButtonText:"Hủy"})).isConfirmed&&await b():r.push({name:"login"})},b=async()=>{var o,s;try{const l=new Date;l.setHours(0,0,0,0);const a={ID_DocGia:i.value._id,ID_Sach:u.id,NgayMuon:l,TrangThai:"DangKy"},S=await j.borrow(a);c.success(S.message)}catch(l){const a=((s=(o=l.response)==null?void 0:o.data)==null?void 0:s.message)||"Có lỗi xảy ra. Vui lòng thử lại.";c.error(a)}},B=F(),i=k(()=>B.getters.userData);return D(async()=>{var o,s;try{v()}catch(l){const a=((s=(o=l.response)==null?void 0:o.data)==null?void 0:s.message)||"Có lỗi xảy ra. Vui lòng thử lại.";c.error(a)}}),(o,s)=>{var l;return g(),h("div",X,[t("div",{class:"h-ful w-fit"},[t("div",{class:"w-10 h-10 rounded-full flex justify-center items-center hover:bg-[#FEF6DF] cursor-pointer border shadow bg-white",onClick:x},s[0]||(s[0]=[t("i",{class:"fa-solid fa-arrow-left"},null,-1)]))]),t("div",L,[t("div",q,[t("div",G,[t("div",V,[t("img",{src:d.value,alt:"",class:"object-contain h-full w-auto min-w-fit rounded-md shadow-lg"},null,8,H)]),t("div",I,[t("div",E,[t("div",R,[t("div",U,[t("span",O,n(e.value.TenSach),1)]),t("div",K,[t("table",z,[t("tbody",null,[t("tr",null,[s[1]||(s[1]=t("td",{class:"px-4 py-2 font-semibold whitespace-nowrap align-top"}," Mã sách",-1)),t("td",A,n(e.value.MaSach),1)]),t("tr",null,[s[2]||(s[2]=t("td",{class:"px-4 py-2 font-semibold whitespace-nowrap align-top"}," Thể loại",-1)),t("td",J,n(e.value.TheLoai.TenMucSach),1)]),t("tr",null,[s[3]||(s[3]=t("td",{class:"px-4 py-2 font-semibold whitespace-nowrap align-top"},"Tác giả",-1)),t("td",P,n(e.value.TacGia),1)]),t("tr",null,[s[4]||(s[4]=t("td",{class:"px-4 py-2 font-semibold whitespace-nowrap align-top"}," Nhà xuất bản ",-1)),t("td",Q,n(e.value.NXB.TenNXB),1)]),t("tr",null,[s[5]||(s[5]=t("td",{class:"px-4 py-2 font-semibold whitespace-nowrap align-top"}," Năm xuất bản ",-1)),t("td",W,n(e.value.NamXuatBan),1)]),t("tr",null,[s[6]||(s[6]=t("td",{class:"px-4 py-2 font-semibold whitespace-nowrap align-top"}," Số lượng",-1)),t("td",Y,n(e.value.SoLuongHienTai)+" quyển ",1)]),t("tr",null,[s[7]||(s[7]=t("td",{class:"px-4 py-2 font-semibold whitespace-nowrap align-top"}," Đơn giá",-1)),t("td",Z,n(y(e.value.DonGia)),1)])])])])])]),t("div",$,[!((l=i.value)!=null&&l.ChucVu)||i.value===null?(g(),h("div",tt,[t("button",{onClick:_,class:"rounded-xl hover:bg-[#FEF6DF] bg-[#FFD573] px-5 py-3"},"Đăng ký mượn")])):C("",!0)])])])])])])}}};export{lt as default};
